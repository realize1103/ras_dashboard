#!/bin/bash

# ê°„ë‹¨í•œ ë§¤ì§ë¯¸ëŸ¬ ìŠ¤í¬ë¦½íŠ¸
# ë¸Œë¼ìš°ì €ë§Œ ì—´ê³  ì „ì²´í™”ë©´ìœ¼ë¡œ ì „í™˜

echo "ðŸªž RAS Dashboard ë§¤ì§ë¯¸ëŸ¬ë¥¼ ì‹œìž‘í•©ë‹ˆë‹¤..."

# ê¸°ì¡´ í”„ë¡œì„¸ìŠ¤ ì •ë¦¬
pkill -f "next dev" 2>/dev/null || true

# Next.js ì„œë²„ ì‹œìž‘ (ë°±ê·¸ë¼ìš´ë“œ)
echo "ðŸ“¡ Next.js ì„œë²„ë¥¼ ì‹œìž‘í•©ë‹ˆë‹¤..."
npm run dev &
NEXT_PID=$!

# ì„œë²„ ì‹œìž‘ ëŒ€ê¸°
echo "â³ ì„œë²„ ì‹œìž‘ì„ ê¸°ë‹¤ë¦½ë‹ˆë‹¤..."
sleep 6

# ë¸Œë¼ìš°ì € ì—´ê¸°
echo "ðŸŒ ë¸Œë¼ìš°ì €ë¥¼ ì—½ë‹ˆë‹¤..."
open http://localhost:3000

echo "âœ… ë§¤ì§ë¯¸ëŸ¬ê°€ ì‹œìž‘ë˜ì—ˆìŠµë‹ˆë‹¤!"
echo "ðŸ“± ë¸Œë¼ìš°ì €ì—ì„œ F11ì„ ëˆŒëŸ¬ ì „ì²´í™”ë©´ìœ¼ë¡œ ì „í™˜í•˜ì„¸ìš”."
echo "âŒ¨ï¸  Ctrl+Cë¡œ ì¢…ë£Œí•˜ì„¸ìš”."

# ì •ë¦¬ í•¨ìˆ˜
cleanup() {
    echo "ðŸ›‘ ë§¤ì§ë¯¸ëŸ¬ë¥¼ ì¢…ë£Œí•©ë‹ˆë‹¤..."
    kill $NEXT_PID 2>/dev/null || true
    exit 0
}

trap cleanup SIGINT SIGTERM
wait $NEXT_PID
